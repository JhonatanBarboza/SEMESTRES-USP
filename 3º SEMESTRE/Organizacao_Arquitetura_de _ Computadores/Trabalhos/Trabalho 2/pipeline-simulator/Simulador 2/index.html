<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de Pipeline RISC-V</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>üöÄ Simulador de Pipeline RISC-V</h1>
        
        <div class="main-content">
            <div class="code-panel">
                <h2>üíª C√≥digo Assembly RISC-V</h2>
                <textarea id="codeEditor" placeholder="Digite seu c√≥digo RISC-V Assembly aqui...
Exemplo:
addi x1, x0, 10
addi x2, x0, 20
add x3, x1, x2
sub x4, x3, x1
sw x4, 0(x0)
lw x5, 0(x0)">addi x1, x0, 10
addi x2, x0, 20
add x3, x1, x2
sub x4, x3, x1
sw x4, 0(x0)
lw x5, 0(x0)</textarea>
                
                <div class="controls">
                    <button class="btn-primary" onclick="startSimulation()">‚ñ∂Ô∏è Carregar</button>
                    <button class="btn-success" onclick="stepForward()" id="stepBtn" disabled>‚è≠Ô∏è Pr√≥ximo Ciclo</button>
                    <button class="btn-secondary" onclick="resetSimulation()">üîÑ Reset</button>
                    <button class="btn-warning" onclick="toggleAutoRun()" id="autoBtn">‚ö° Auto Executar</button>
                </div>
            </div>

            <div class="pipeline-visual">
                <h2>üîÑ Pipeline Visualization</h2>
                <div class="cycle-counter" id="cycleCounter">Ciclo: 0</div>
                
                <div class="pipeline-stage" id="stage-if">
                    <div class="stage-name">IF</div>
                    <div class="stage-content" id="if-content">Instruction Fetch</div>
                </div>
                
                <div class="pipeline-stage" id="stage-id">
                    <div class="stage-name">ID</div>
                    <div class="stage-content" id="id-content">Instruction Decode</div>
                </div>
                
                <div class="pipeline-stage" id="stage-ex">
                    <div class="stage-name">EX</div>
                    <div class="stage-content" id="ex-content">Execute</div>
                </div>
                
                <div class="pipeline-stage" id="stage-mem">
                    <div class="stage-name">MEM</div>
                    <div class="stage-content" id="mem-content">Memory Access</div>
                </div>
                
                <div class="pipeline-stage" id="stage-wb">
                    <div class="stage-name">WB</div>
                    <div class="stage-content" id="wb-content">Write Back</div>
                </div>

                <div id="hazardInfo"></div>
            </div>
        </div>

        <div class="status-panel">
            <div class="status-box">
                <h3>üìä Registradores</h3>
                <div class="registers-grid" id="registersGrid"></div>
            </div>
            
            <div class="status-box">
                <h3>üíæ Mem√≥ria de Instru√ß√µes</h3>
                <div class="instruction-memory" id="instructionMemory"></div>
                
                <h3 style="margin-top: 20px;">üóÑÔ∏è Performance</h3>
                <div id="performanceStats">
                    <div>Instru√ß√µes: <span id="instCount">0</span></div>
                    <div>Ciclos: <span id="cycleCount">0</span></div>
                    <div>Stalls: <span id="stallCount">0</span></div>
                    <div>CPI: <span id="cpiValue">0.00</span></div>
                </div>
            </div>
        </div>

        <div class="help-section">
            <h2>üìö Ajuda e Instru√ß√µes Suportadas</h2>
            
            <details>
                <summary>Instru√ß√µes Suportadas</summary>
                <div class="help-content">
                    <strong>Instru√ß√µes Tipo R:</strong>
                    <ul>
                        <li><code>add rd, rs1, rs2</code> - Adi√ß√£o</li>
                        <li><code>sub rd, rs1, rs2</code> - Subtra√ß√£o</li>
                        <li><code>mul rd, rs1, rs2</code> - Multiplica√ß√£o</li>
                        <li><code>div rd, rs1, rs2</code> - Divis√£o</li>
                        <li><code>and rd, rs1, rs2</code> - AND l√≥gico</li>
                        <li><code>or rd, rs1, rs2</code> - OR l√≥gico</li>
                        <li><code>xor rd, rs1, rs2</code> - XOR l√≥gico</li>
                    </ul>
                    <br>
                    <strong>Instru√ß√µes Tipo I:</strong>
                    <ul>
                        <li><code>addi rd, rs1, imm</code> - Adi√ß√£o com imediato</li>
                        <li><code>lw rd, offset(rs1)</code> - Load word</li>
                    </ul>
                    <br>
                    <strong>Instru√ß√µes Tipo S:</strong>
                    <ul>
                        <li><code>sw rs2, offset(rs1)</code> - Store word</li>
                    </ul>
                    <br>
                    <strong>Instru√ß√µes de Branch:</strong>
                    <ul>
                        <li><code>beq rs1, rs2, label</code> - Branch if equal</li>
                        <li><code>bne rs1, rs2, label</code> - Branch if not equal</li>
                    </ul>
                    <br>
                    <strong>Instru√ß√µes de Jump:</strong>
                    <ul>
                        <li><code>jal rd, label</code> - Jump and link</li>
                        <li><code>jalr rd, rs1</code> - Jump and link register</li>
                    </ul>
                    <br>
                    <strong>Instru√ß√µes de Controle:</strong>
                    <ul>
                        <li><code>ecall</code> - Chamada de sistema</li>

                        <li>C√≥digo 1: Imprimir inteiro (valor em x11)</li>
                        <li>C√≥digo 10: Terminar programa</li>

                        <li>Usa registradores x10 (c√≥digo) e x11 (argumento)</li>
                    </ul>
                </div>
            </details>
            
            <details>
                <summary>Hazards Detectados</summary>
                <div class="help-content">
                    <strong>Data Hazards:</strong>
                    <ul>
                        <li>RAW (Read After Write) - Detectado e resolvido com forwarding ou stalls</li>
                        <li>Load-Use - Requer stall obrigat√≥rio de 1 ciclo</li>
                    </ul>
                    
                    <strong>Control Hazards:</strong>
                    <ul>
                        <li>Branch - Flush do pipeline quando branch √© tomado</li>
                    </ul>
                </div>
            </details>
            
            <details>
                <summary>Como Usar</summary>
                <div class="help-content">
                    <ol>
                        <li>Digite seu c√≥digo RISC-V Assembly na √°rea de texto</li>
                        <li>Clique em "Executar" para compilar o c√≥digo</li>
                        <li>Use "Pr√≥ximo Ciclo" para avan√ßar step-by-step</li>
                        <li>Use "Auto Executar" para execu√ß√£o autom√°tica</li>
                        <li>Observe os hazards sendo detectados e resolvidos em tempo real</li>
                    </ol>
                </div>
            </details>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>